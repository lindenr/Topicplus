/* Paste the below line into the URL bar of firefox if ctrl+shift+K does nothing - otherwise see extract-merge.js */

javascript:(function(a,b){function l(){if(j==0)c+='<table width=95%><tr class="bkSegListHeader"><td><b>Booking ID</b></td>\n\t\t<td width="100px"><b>Booking date</b></td><td><b>Account</b></td><td width="15px"><b>A</b></td>\n\t\t<td width="15px"><b>C</b></td><td width="15px"><b>I</b></td><td><b>Dep</b></td>\n\t\t<td width="30px"><b>Nts</b></td><td width="100px"><b>Tour</b></td><td width="200px"><b>Lead</b></td>\n\t\t<td width="60px"><b>Sale</b></td><td width="80px"><b>Cost</b></td><td width="70px"><b>Received</b></td>\n\t\t<td width="25px"><b>Qty</b></td><td width="70px"><b>Each</b></td><td width="70px"><b>Sale</b></td>\n\t\t<td width="100px"><b>Supplier</b></td><td width="70px"><b>Cost</b></td></tr>';c+="<br />";if(j<k.length&&k[j].length)i(k[j]);else a.body.innerHTML=c+"</table>"}function i(b){function g(){++d;if(d==4){++j;l()}}var d=0;a.body.innerHTML=""+j+" of "+k.length+".";var e=jQuery;var f={id:b};e.get("/render.php?page=booking_bkLoad&mode=e&id="+b,function(a){var d=a.indexOf("<td><b>Tour</b></td>")+24,i=a.indexOf("<",d);var k=a.slice(d,i);d=a.indexOf("<td><b>Lead:</b></td>")+25;i=a.indexOf("<",d);var m=a.slice(d,i);if(k==""||!/\S/.test(m)){c+='<br /><tr style="color:red;font-weight:bold"><td>'+b+"</td><td>DATA MISSING -- possibly no booking.</td></tr>";++j;return l()}f.tour=k;var n=a.indexOf("<b>Pax:</b></td><td>")+20;var o=a.slice(n,a.indexOf("<",n));o=o.split("/");f.A=o[0];f.C=o[1];f.I=o[2];n=a.indexOf("<b>Dep:</b></td><td>",n)+20;f.dep=a.slice(n,a.indexOf("<",n));n=a.indexOf("<b>Value:</b></td><td>")+22;f.sale=a.slice(n,a.indexOf("<",n));e.get("/render.php?page=booking_bkBasic",function p(a){n=a.indexOf("Booking Administration");if(n!=-1){c+='<br /><tr style="color:red;font-weight:bold"><td>'+b+"</td><td>DATA LOCKED -- possibly try again?</td></tr>";++j;return l()}n=a.indexOf('id="bkBookingDate"');n=a.indexOf("value",n)+7;var d=a.indexOf('"',n);f.dateBooked=a.slice(n,d);n=a.indexOf('id="bkTypeDirect"');var i=a.indexOf("checked",n);if(i==-1||i>a.indexOf(">",n))n=a.indexOf('id="ar2"',n);else n=a.indexOf('id="cr2"',n);n=a.indexOf("value",n)+7;d=a.indexOf('"',n+1);f.account=a.slice(n,d);n=a.indexOf("Duration (Nts)");n=a.indexOf("value",n)+7;d=a.indexOf('"',n);f.nts=a.slice(n,d);n=a.indexOf('<td><a href="#" onclick="passengerPopup');var k=true;if(n==-1)k=false;if(k){n=a.indexOf(",",n)+1;n=a.indexOf(",",n)+1;n=a.indexOf(",",n)+2;d=a.indexOf('"',n)-2;var m="/render.php?page=booking_p-bkPaxEntry&mode=e&bookingID="+b+"&tourID="+f.tour+"&bookingPaxID="+a.slice(n,d)+"&depDateID="+f.dep}else{n=a.indexOf("<b>Lead:</b></td><td>")+21;f.leadP='<font style="color:red;font-weight:bold">Booking cancelled ('+a.slice(n,a.indexOf("<",n))+")</font>"}e.get(m,function(a,c){if(k){n=a.indexOf('name="bkpaxSurname"');n=a.indexOf("value",n)+7;f.leadP=a.slice(n,a.indexOf('"',n))+"/";n=a.indexOf('name="bkpaxForename"');n=a.indexOf("value",n)+7;f.leadP+=a.slice(n,a.indexOf('"',n))+"/";n=a.indexOf('name="bkpaxTitle"');n=a.indexOf('selected="selected"',n)+20;f.leadP+=a.slice(n,a.indexOf("<",n))}e.get("/render.php?page=booking_bkSales",function(a){i=a.indexOf("<b>Total Cost:</b>")+30;i=a.indexOf(">",i)+1;f.total=a.slice(i,a.indexOf("<",i));i=a.indexOf("Received:</b></td>")+22;f.rcvd=a.slice(i,a.indexOf("<",i));var c=a.indexOf('<table width="95%">')+19,d=a.indexOf('</table></div><div style="mar');if(d==-1)d=a.indexOf('</table></div></div><div class="boxFooter"></div><br />');a=a.slice(c,d);c=0;d=a.indexOf("</tr>")+5;var e=a.slice(0,c),g=a.slice(d);a=e+g;for(var i=a.indexOf("<tr>")+4;i!=-1+4;i=a.indexOf("<tr>",i+1)+4){e=a.slice(0,i);g=a.slice(i);a=e+"<td>"+b+"</td>"+g}if(a==e+g){a=e+'<tr style="color:red;font-weight:bold"><td>'+b+"</td><td>NO SALES DATA</td></tr>"+g}for(i=a.indexOf("</tr>");i!=-1;i=a.indexOf("</tr>",i)){var j=a.lastIndexOf("<td",i);a=a.slice(0,j)+a.slice(i)}for(i=a.indexOf("<tr");i!=-1;i=a.indexOf("<tr",i)){i=a.indexOf("<td",i);i=a.indexOf("<td",i+4);a=a.slice(0,i)+"<td> </td>".times(7)+a.slice(i);i+=70;i=a.indexOf("<td",i+4);i=a.indexOf("<td",i+4);a=a.slice(0,i)+"<td> </td>".times(3)+a.slice(i)}h(f,a)}).done(g)}).done(g)}).done(g)}).done(g)}function h(a,b){c+=d+a.id+e+a.dateBooked+e+a.account+e+a.A+e+a.C+e+a.I+e+a.dep+e+a.nts+e+a.tour+e+a.leadP+e+a.sale+e+a.total+e+a.rcvd+f+b}function g(b,c){var d=a;var e=d.getElementsByTagName("head")[0];var f=d.createElement("script");f.type="text/javascript";f.src=b;f.onreadystatechange=c;f.onload=c;e.appendChild(f)}var c="",d="<tr><td>",e="</td><td>",f="</td></tr>";String.prototype.times=function(a){return Array.prototype.join.call({length:a+1},this)};var j=0;var k=prompt("What numbers? (space-delimited)").split(" ");g("http://code.jquery.com/jquery-1.7.1.min.js",l)})(window.document);void 0